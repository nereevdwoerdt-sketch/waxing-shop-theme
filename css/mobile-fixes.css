/**
 * Mobile Fixes - Waxing Shop Theme
 *
 * Comprehensive mobile optimizations for better UX on small screens
 * @since 5.8
 */

/* ==========================================================================
   1. BASE MOBILE RESETS
   ========================================================================== */

/* Prevent iOS zoom on input focus */
@media screen and (max-width: 768px) {
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="number"],
    input[type="password"],
    input[type="search"],
    select,
    textarea {
        font-size: 16px !important;
    }
}

/* Safe area insets for notched devices */
@supports (padding: max(0px)) {
    body {
        padding-left: max(0px, env(safe-area-inset-left));
        padding-right: max(0px, env(safe-area-inset-right));
    }

    .site-header,
    .site-footer {
        padding-left: max(20px, env(safe-area-inset-left));
        padding-right: max(20px, env(safe-area-inset-right));
    }
}

/* Body scroll lock when modal/menu is open */
body.menu-open,
body.modal-open,
body.cart-open,
body.filter-open {
    overflow: hidden !important;
    position: fixed;
    width: 100%;
    height: 100%;
}

/* ==========================================================================
   2. TOUCH TARGETS - Minimum 44x44px
   ========================================================================== */

@media screen and (max-width: 768px) {
    /* Buttons */
    .btn,
    button,
    [role="button"] {
        min-height: 44px;
        min-width: 44px;
        padding: 12px 20px;
    }

    .btn-sm {
        min-height: 44px;
        padding: 10px 16px;
    }

    /* Links in navigation */
    .nav-link,
    .menu-item a,
    .footer-link {
        min-height: 44px;
        display: inline-flex;
        align-items: center;
    }

    /* Form elements */
    input[type="checkbox"],
    input[type="radio"] {
        min-width: 24px;
        min-height: 24px;
    }

    /* Checkbox/radio labels */
    .calc-zone-option,
    .form-checkbox label,
    .form-radio label {
        min-height: 44px;
        padding: 10px 12px;
    }

    /* Close buttons */
    .modal-close,
    .drawer-close,
    .cart-close {
        min-width: 44px;
        min-height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Quantity buttons */
    .quantity-btn,
    .qty-btn {
        min-width: 44px;
        min-height: 44px;
    }

    /* Icon buttons */
    .icon-btn,
    .header-icon {
        min-width: 44px;
        min-height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
}

/* ==========================================================================
   3. HEADER & NAVIGATION
   ========================================================================== */

@media screen and (max-width: 768px) {
    .site-header {
        position: sticky;
        top: 0;
        z-index: 1000;
        background: var(--white);
    }

    .header-container {
        padding: 12px 16px;
        gap: 12px;
    }

    /* Logo sizing */
    .site-logo img {
        max-height: 36px;
        width: auto;
    }

    /* Mobile menu button */
    .mobile-menu-toggle {
        min-width: 44px;
        min-height: 44px;
        padding: 8px;
    }

    /* Header icons */
    .header-actions {
        gap: 4px;
    }

    .header-cart-link,
    .header-search-btn {
        min-width: 44px;
        min-height: 44px;
        padding: 8px;
    }

    /* Cart count badge */
    .cart-count {
        min-width: 18px;
        height: 18px;
        font-size: 11px;
        top: 4px;
        right: 4px;
    }
}

/* Mobile menu overlay */
@media screen and (max-width: 768px) {
    .mobile-nav {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--white);
        z-index: 9999;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    .mobile-nav.is-open {
        transform: translateX(0);
    }

    .mobile-nav-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 16px;
        border-bottom: 1px solid var(--border);
        position: sticky;
        top: 0;
        background: var(--white);
    }

    .mobile-nav-links {
        padding: 16px;
    }

    .mobile-nav-link {
        display: block;
        padding: 16px 0;
        font-size: 18px;
        border-bottom: 1px solid var(--border);
    }
}

/* ==========================================================================
   4. HERO SECTION
   ========================================================================== */

@media screen and (max-width: 768px) {
    .hero-section {
        min-height: auto;
        padding: 60px 20px 40px;
    }

    .hero-content {
        text-align: center;
    }

    .hero-title {
        font-size: clamp(1.75rem, 6vw, 2.5rem);
        line-height: 1.2;
    }

    .hero-subtitle {
        font-size: 1rem;
        margin-bottom: 24px;
    }

    .hero-eyebrow {
        font-size: 0.8125rem;
    }

    /* Hero buttons stack on mobile */
    .hero-buttons {
        flex-direction: column;
        gap: 12px;
        width: 100%;
    }

    .hero-buttons .btn {
        width: 100%;
        justify-content: center;
    }

    /* Hero features horizontal scroll */
    .hero-features {
        display: flex;
        gap: 16px;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        padding-bottom: 8px;
        margin: 0 -20px;
        padding: 0 20px 8px;
    }

    .hero-feature {
        flex: 0 0 auto;
        min-width: 100px;
        scroll-snap-align: start;
        text-align: center;
    }
}

/* ==========================================================================
   5. PRODUCT CARDS
   ========================================================================== */

@media screen and (max-width: 768px) {
    .products-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        padding: 0 16px;
    }

    .product-card {
        padding: 12px;
    }

    /* Always show actions on mobile (no hover) */
    .product-card .product-actions {
        opacity: 1;
        transform: none;
        position: relative;
        bottom: auto;
        left: auto;
        right: auto;
        margin-top: 12px;
    }

    .product-card .quick-add-btn {
        width: 100%;
        padding: 10px 12px;
        font-size: 0.8125rem;
    }

    /* Product image */
    .product-image {
        aspect-ratio: 1;
        margin-bottom: 12px;
    }

    /* Product info */
    .product-title {
        font-size: 0.875rem;
        line-height: 1.3;
        margin-bottom: 4px;
        /* Limit to 2 lines */
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .product-price {
        font-size: 1rem;
    }

    /* Hide secondary info on small screens */
    .product-meta,
    .product-rating {
        display: none;
    }
}

/* Very small screens */
@media screen and (max-width: 374px) {
    .products-grid {
        grid-template-columns: 1fr;
        gap: 16px;
    }

    .product-card {
        display: grid;
        grid-template-columns: 100px 1fr;
        gap: 12px;
        padding: 12px;
    }

    .product-image {
        margin-bottom: 0;
    }

    .product-info {
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
}

/* ==========================================================================
   6. STARTER SETS CARDS
   ========================================================================== */

@media screen and (max-width: 768px) {
    .starter-sets-grid {
        grid-template-columns: 1fr;
        gap: 20px;
        padding: 0 16px;
    }

    .starter-set-card {
        padding: 20px;
    }

    .starter-set-features {
        font-size: 0.875rem;
    }

    .starter-set-features li {
        padding: 8px 0;
    }

    .starter-set-price {
        font-size: 1.5rem;
    }

    .starter-set-btn {
        width: 100%;
    }
}

/* ==========================================================================
   7. QUIZ SECTION
   ========================================================================== */

@media screen and (max-width: 768px) {
    .quiz-container {
        padding: 20px 16px;
        margin: 0 16px;
    }

    .quiz-question {
        font-size: 1.125rem;
        margin-bottom: 20px;
    }

    .quiz-options {
        gap: 12px;
    }

    .quiz-option {
        padding: 16px;
        min-height: 44px;
    }

    .quiz-option-text {
        font-size: 0.9375rem;
    }

    .quiz-progress {
        margin-bottom: 20px;
    }

    /* Quiz result */
    .quiz-result {
        padding: 20px;
    }

    .quiz-result-product {
        flex-direction: column;
        text-align: center;
    }

    .quiz-result-image {
        max-width: 200px;
        margin: 0 auto 16px;
    }
}

/* ==========================================================================
   8. CALCULATOR SECTION
   ========================================================================== */

@media screen and (max-width: 768px) {
    .calculator-box {
        padding: 20px 16px;
        margin: 0 16px;
    }

    .calc-row {
        margin-bottom: 20px;
    }

    .calc-label {
        font-size: 0.9375rem;
        margin-bottom: 12px;
    }

    /* Zone checkboxes in 1 column on mobile */
    .calc-zones {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .calc-zone-option {
        padding: 14px 12px;
    }

    .zone-name {
        font-size: 0.9375rem;
    }

    .zone-price {
        font-size: 0.8125rem;
    }

    /* Results comparison */
    .calc-comparison {
        flex-direction: column;
        gap: 16px;
    }

    .calc-column {
        width: 100%;
        padding: 16px;
    }

    .calc-vs {
        display: none;
    }

    .calc-column-value {
        font-size: 1.75rem;
    }

    .calc-saving-value {
        font-size: 2rem;
    }
}

/* ==========================================================================
   9. TESTIMONIALS/REVIEWS
   ========================================================================== */

@media screen and (max-width: 768px) {
    .testimonials-slider {
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        display: flex;
        gap: 16px;
        padding: 0 16px 16px;
        margin: 0 -16px;
    }

    .testimonial-card {
        flex: 0 0 calc(100vw - 64px);
        max-width: 320px;
        scroll-snap-align: center;
        padding: 20px;
    }

    .testimonial-text {
        font-size: 0.9375rem;
        line-height: 1.6;
    }

    .testimonial-author {
        font-size: 0.875rem;
    }

    /* Slider dots */
    .testimonials-dots {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin-top: 16px;
    }
}

/* ==========================================================================
   10. FAQ SECTION
   ========================================================================== */

@media screen and (max-width: 768px) {
    .faq-list {
        padding: 0 16px;
    }

    .faq-item {
        border-radius: var(--radius-md);
    }

    .faq-question {
        padding: 16px;
        font-size: 0.9375rem;
        min-height: 44px;
    }

    .faq-answer {
        padding: 0 16px 16px;
        font-size: 0.875rem;
    }

    .faq-icon {
        min-width: 24px;
        min-height: 24px;
    }
}

/* ==========================================================================
   11. CART DRAWER / MINI CART
   ========================================================================== */

@media screen and (max-width: 768px) {
    .cart-drawer {
        width: 100%;
        max-width: 100%;
        height: 100%;
        border-radius: 0;
    }

    .cart-drawer-header {
        padding: 16px;
        position: sticky;
        top: 0;
        background: var(--white);
        z-index: 10;
    }

    .cart-drawer-content {
        padding: 16px;
        flex: 1;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    .cart-drawer-footer {
        padding: 16px;
        position: sticky;
        bottom: 0;
        background: var(--white);
        border-top: 1px solid var(--border);
        padding-bottom: max(16px, env(safe-area-inset-bottom));
    }

    /* Cart items */
    .cart-item {
        padding: 12px 0;
        gap: 12px;
    }

    .cart-item-image {
        width: 70px;
        height: 70px;
    }

    .cart-item-title {
        font-size: 0.875rem;
        line-height: 1.3;
    }

    .cart-item-price {
        font-size: 0.9375rem;
    }

    /* Quantity controls */
    .cart-item-quantity {
        gap: 4px;
    }

    .cart-item-qty-btn {
        width: 32px;
        height: 32px;
    }

    /* Remove button */
    .cart-item-remove {
        min-width: 44px;
        min-height: 44px;
    }

    /* Shipping progress */
    .cart-shipping-info {
        padding: 12px;
        margin-bottom: 16px;
    }

    .cart-shipping-text {
        font-size: 0.8125rem;
    }
}

/* ==========================================================================
   12. MODALS
   ========================================================================== */

@media screen and (max-width: 768px) {
    .modal {
        align-items: flex-end;
        padding: 0;
    }

    .modal-content {
        width: 100%;
        max-width: 100%;
        max-height: 90vh;
        border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        margin: 0;
    }

    .modal-header {
        padding: 16px;
        position: sticky;
        top: 0;
        background: var(--white);
        z-index: 10;
    }

    .modal-body {
        padding: 16px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    .modal-footer {
        padding: 16px;
        padding-bottom: max(16px, env(safe-area-inset-bottom));
    }

    .modal-close {
        min-width: 44px;
        min-height: 44px;
    }
}

/* Full screen modal variant */
@media screen and (max-width: 768px) {
    .modal--fullscreen .modal-content {
        height: 100%;
        max-height: 100%;
        border-radius: 0;
    }
}

/* ==========================================================================
   13. FORMS
   ========================================================================== */

@media screen and (max-width: 768px) {
    .form-row {
        flex-direction: column;
        gap: 16px;
    }

    .form-group {
        width: 100%;
    }

    .form-label {
        font-size: 0.875rem;
        margin-bottom: 6px;
    }

    .form-input,
    .form-select,
    .form-textarea {
        padding: 14px 16px;
        font-size: 16px; /* Prevent iOS zoom */
    }

    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
        /* Stronger focus state for touch */
        box-shadow: 0 0 0 3px var(--sage-light);
    }

    /* Error messages */
    .form-error {
        font-size: 0.8125rem;
        margin-top: 6px;
    }

    /* Form actions */
    .form-actions {
        flex-direction: column;
        gap: 12px;
    }

    .form-actions .btn {
        width: 100%;
    }
}

/* ==========================================================================
   14. FOOTER
   ========================================================================== */

@media screen and (max-width: 768px) {
    .site-footer {
        padding: 40px 16px 20px;
    }

    .footer-grid {
        grid-template-columns: 1fr;
        gap: 32px;
    }

    .footer-column {
        text-align: center;
    }

    .footer-heading {
        font-size: 1rem;
        margin-bottom: 12px;
    }

    .footer-links {
        gap: 8px;
    }

    .footer-link {
        min-height: 44px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    /* Payment icons */
    .footer-payments-bar {
        flex-direction: column;
        gap: 12px;
        padding: 16px;
    }

    .payment-icons {
        flex-wrap: wrap;
        justify-content: center;
        gap: 16px;
    }

    .payment-icon {
        width: 40px;
        height: 28px;
    }

    /* Copyright */
    .footer-bottom {
        flex-direction: column;
        gap: 12px;
        text-align: center;
        padding-top: 20px;
        padding-bottom: max(20px, env(safe-area-inset-bottom));
    }
}

/* ==========================================================================
   15. SECTIONS GENERAL
   ========================================================================== */

@media screen and (max-width: 768px) {
    .section {
        padding: 48px 0;
    }

    .section-header {
        padding: 0 16px;
        margin-bottom: 24px;
    }

    .section-title {
        font-size: clamp(1.5rem, 5vw, 2rem);
    }

    .section-subtitle {
        font-size: 0.9375rem;
    }

    .section-eyebrow {
        font-size: 0.75rem;
    }

    /* Split header stacks on mobile */
    .section-header--split {
        flex-direction: column;
        gap: 16px;
        text-align: center;
    }

    .section-header--split .btn {
        align-self: center;
    }
}

/* ==========================================================================
   16. WOOCOMMERCE SPECIFIC
   ========================================================================== */

@media screen and (max-width: 768px) {
    /* Shop page */
    .woocommerce-products-header {
        padding: 20px 16px;
    }

    /* Filters */
    .shop-filters {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--white);
        z-index: 9999;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    .shop-filters.is-open {
        transform: translateX(0);
    }

    .filter-toggle-btn {
        display: flex;
        width: 100%;
        margin: 0 16px 16px;
        max-width: calc(100% - 32px);
    }

    /* Product single page */
    .single-product .product-gallery {
        margin-bottom: 24px;
    }

    .single-product .product-summary {
        padding: 0 16px;
    }

    .single-product .product-title {
        font-size: 1.5rem;
    }

    .single-product .product-price {
        font-size: 1.25rem;
    }

    .single-product .add-to-cart-btn {
        width: 100%;
        position: sticky;
        bottom: 16px;
        z-index: 100;
    }

    /* Checkout */
    .woocommerce-checkout .col2-set {
        display: flex;
        flex-direction: column;
    }

    .woocommerce-checkout .col-1,
    .woocommerce-checkout .col-2 {
        width: 100%;
    }

    /* Order summary */
    .order-summary {
        position: relative;
        margin-top: 24px;
    }

    /* Thank you page */
    .woocommerce-order-received {
        padding: 24px 16px;
    }
}

/* ==========================================================================
   17. UTILITY CLASSES
   ========================================================================== */

@media screen and (max-width: 768px) {
    /* Hide on mobile */
    .hide-mobile,
    .desktop-only {
        display: none !important;
    }

    /* Show only on mobile */
    .show-mobile,
    .mobile-only {
        display: block !important;
    }

    /* Text alignment */
    .text-center-mobile {
        text-align: center !important;
    }

    /* Full width on mobile */
    .full-width-mobile {
        width: 100% !important;
        max-width: 100% !important;
    }

    /* Stack on mobile */
    .stack-mobile {
        flex-direction: column !important;
    }

    /* No padding on mobile */
    .no-padding-mobile {
        padding: 0 !important;
    }

    /* Horizontal scroll container */
    .scroll-x-mobile {
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }

    .scroll-x-mobile::-webkit-scrollbar {
        display: none;
    }
}

/* ==========================================================================
   18. ANIMATIONS & TRANSITIONS (Reduced motion)
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

/* ==========================================================================
   19. PRINT STYLES
   ========================================================================== */

@media print {
    .site-header,
    .site-footer,
    .mobile-nav,
    .cart-drawer,
    .modal,
    .btn,
    .quiz-section,
    .calculator-section {
        display: none !important;
    }

    body {
        font-size: 12pt;
        line-height: 1.5;
    }

    .products-grid {
        display: block;
    }

    .product-card {
        page-break-inside: avoid;
        margin-bottom: 20pt;
    }
}

/* ==========================================================================
   20. EXTRA SMALL SCREENS (320px)
   ========================================================================== */

@media screen and (max-width: 374px) {
    .hero-title {
        font-size: 1.5rem;
    }

    .section-title {
        font-size: 1.25rem;
    }

    .btn {
        padding: 12px 16px;
        font-size: 0.875rem;
    }

    .starter-set-card {
        padding: 16px;
    }

    .calculator-box {
        padding: 16px 12px;
    }

    .calc-column-value {
        font-size: 1.5rem;
    }

    .calc-saving-value {
        font-size: 1.75rem;
    }
}

/* ==========================================================================
   21. LANDSCAPE ORIENTATION FIXES
   ========================================================================== */

@media screen and (max-height: 500px) and (orientation: landscape) {
    .hero-section {
        min-height: auto;
        padding: 30px 20px;
    }

    .hero-features {
        flex-wrap: nowrap;
    }

    .modal-content {
        max-height: 100vh;
    }

    .cart-drawer {
        height: 100vh;
    }
}

/* ==========================================================================
   22. HIGH CONTRAST MODE
   ========================================================================== */

@media (prefers-contrast: high) {
    .btn {
        border: 2px solid currentColor;
    }

    .product-card {
        border: 2px solid var(--dark);
    }

    .form-input,
    .form-select {
        border: 2px solid var(--dark);
    }

    .faq-item {
        border: 2px solid var(--dark);
    }
}
